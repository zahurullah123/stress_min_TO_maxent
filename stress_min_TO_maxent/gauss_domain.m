function gs=gauss_domain(coords,numcell,conn,nQ)%Domains 

if nQ==1
    gauss(1,1) = 0;
    gauss(2,1) = 2;
elseif nQ==2
    gauss(1,1) =-0.5773502691896257645091488;
    gauss(1,2) =+0.5773502691896257645091488;
    
    gauss(2,1) = 1;
    gauss(2,2) = 1;
elseif nQ==3
    gauss(1,1) =-0.7745966692414833770358531;
    gauss(1,2) = 0;
    gauss(1,3) =+0.7745966692414833770358531;
    
    gauss(2,1) = 0.5555555555555555555555556;
    gauss(2,2) = 0.8888888888888888888888889;
    gauss(2,3) = 0.5555555555555555555555556;
elseif nQ==4
    gauss(1,1) =-0.8611363115940525752239465;
    gauss(1,2) =-0.3399810435848562648026658;
    gauss(1,3) =+0.3399810435848562648026658;
    gauss(1,4) =+0.8611363115940525752239465;
    
    gauss(2,1) = 0.3478548451374538573730639;
    gauss(2,2) = 0.6521451548625461426269361;
    gauss(2,3) = 0.6521451548625461426269361;
    gauss(2,4) = 0.3478548451374538573730639;
elseif nQ==5
    gauss(1,1) =-0.9061798459386639927976269;
    gauss(1,2) =-0.5384693101056830910363144;
    gauss(1,3) = 0;
    gauss(1,4) =+0.5384693101056830910363144;
    gauss(1,5) =+0.9061798459386639927976269;
    
    gauss(2,1) = 0.2369268850561890875142640;
    gauss(2,2) = 0.4786286704993664680412915;
    gauss(2,3) = 0.5688888888888888888888889;
    gauss(2,4) = 0.4786286704993664680412915;
    gauss(2,5) = 0.2369268850561890875142640;
elseif nQ==6
    gauss(1,1) =-0.9324695142031520278123016;
    gauss(1,2) =-0.6612093864662645136613996;
    gauss(1,3) =-0.2386191860831969086305017;
    gauss(1,4) =+0.2386191860831969086305017;
    gauss(1,5) =+0.6612093864662645136613996;
    gauss(1,6) =+0.9324695142031520278123016;
    
    gauss(2,1) = 0.1713244923791703450402961;
    gauss(2,2) = 0.3607615730481386075698335;
    gauss(2,3) = 0.4679139345726910473898703;
    gauss(2,4) = 0.4679139345726910473898703;
    gauss(2,5) = 0.3607615730481386075698335;
    gauss(2,6) = 0.1713244923791703450402961;
elseif nQ==7
    gauss(1,1) =-0.9491079123427585245261897;
    gauss(1,2) =-0.7415311855993944398638648;
    gauss(1,3) =-0.4058451513773971669066064;
    gauss(1,4) =+0;
    gauss(1,5) =+0.4058451513773971669066064;
    gauss(1,6) =+0.7415311855993944398638648;
    gauss(1,7) =+0.9491079123427585245261897;

    gauss(2,1) = 0.1294849661688696932706114;
    gauss(2,2) = 0.2797053914892766679014678;
    gauss(2,3) = 0.3818300505051189449503698;
    gauss(2,4) = 0.4179591836734693877551020;
    gauss(2,5) = 0.3818300505051189449503698;
    gauss(2,6) = 0.2797053914892766679014678;
    gauss(2,7) = 0.1294849661688696932706114;
elseif nQ==8
    gauss(1,1) =-0.9602898564975362316835609;
    gauss(1,2) =-0.7966664774136267395915539;
    gauss(1,3) =-0.5255324099163289858177390;
    gauss(1,4) =-0.1834346424956498049394761;
    gauss(1,5) =+0.1834346424956498049394761;
    gauss(1,6) =+0.5255324099163289858177390;
    gauss(1,7) =+0.7966664774136267395915539;
    gauss(1,8) =+0.9602898564975362316835609;


    gauss(2,1) = 0.1012285362903762591525314;
    gauss(2,2) = 0.2223810344533744705443560;
    gauss(2,3) = 0.3137066458778872873379622;
    gauss(2,4) = 0.3626837833783619829651504;
    gauss(2,5) = 0.3626837833783619829651504;
    gauss(2,6) = 0.3137066458778872873379622;
    gauss(2,7) = 0.2223810344533744705443560;
    gauss(2,8) = 0.1012285362903762591525314;
end    

count=1; 
for e=1:numcell
    for i=1:4
        je=conn(i,e); xe(i)=coords(1,je); ye(i)=coords(2,je);
    end
    for i=1:nQ %4 gauss points
        for j=1:nQ %4 gauss points
            eta=gauss(1,i); psi=gauss(1,j);
            N(1)=(1/4)*(1-psi)*(1-eta); 
            N(2)=(1/4)*(1+psi)*(1-eta); 
            N(3)=(1/4)*(1+psi)*(1+eta); 
            N(4)=(1/4)*(1-psi)*(1+eta); 
            xq=N*xe'; yq=N*ye';% Position of the gauss point
            
            NJpsi(1)=-(1/4)*(1-eta); 
            NJpsi(2)=(1/4)*(1-eta); 
            NJpsi(3)=(1/4)*(1+eta); 
            NJpsi(4)=-(1/4)*(1+eta); 
                        
            NJeta(1)=-(1/4)*(1-psi); 
            NJeta(2)=-(1/4)*(1+psi); 
            NJeta(3)=(1/4)*(1+psi); 
            NJeta(4)=(1/4)*(1-psi); 

            xpsi=NJpsi*xe';ypsi=NJpsi*ye';xeta=NJeta*xe';yeta=NJeta*ye';
            jcob=abs(xpsi*yeta-xeta*ypsi);
            gs(1,count)=xq;
            gs(2,count)=yq;
            gs(3,count)=gauss(2,i)*gauss(2,j);
            gs(4,count)=jcob;
            count=count+1;
        end
    end
end


% figure
% patch('Faces',conn','Vertices',coords','LineWidth',1,...
%       'FaceColor',[0,153/255,153/255],'EdgeColor','k'); 
% hold on 
% plot(coords(1,:),coords(2,:),'ok','markersize',8,'markerfacecolor',[1,0,0])
% xlabel('x','fontsize',14); ylabel('y','fontsize',14);
% axis equal 
% plot(gs(1,5:9:end),gs(2,5:9:end),'xg','markersize',8,'linewidth',2)
